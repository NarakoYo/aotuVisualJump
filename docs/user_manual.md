# 图像识别脚本工具 - 用户使用手册

> 最新更新：增加了日志记录规范化文档，详细说明了日志严重程度级别标记的使用规范；修复了内容框边框显示问题，解决了AssemblyInfo.cs文件导致的编译错误，优化了缓存清理流程。

## 1. 安装说明

### 1.1 系统要求
- 操作系统：Windows 10 或更高版本
- .NET 9.0 或更高版本运行时
- Python 3.8 或更高版本
- 屏幕分辨率：至少 1920×1080
- 可用存储空间：至少 100MB

### 1.2 安装步骤
1. 解压安装包到本地目录
2. 直接运行 `ImageRecognitionApp.exe` (无需安装)
3. 首次运行时会自动检查并安装Python依赖

## 2. 界面介绍

### 2.1 主窗口布局
- **菜单栏**：包含文件、编辑、工具和帮助等菜单
- **工具栏**：提供常用功能的快捷按钮
- **标签页区域**：
  - **脚本编辑器**：编辑脚本内容
  - **执行日志**：查看脚本执行过程和结果
  - **脚本库**：管理已保存的脚本文件
- **状态栏**：显示程序状态和系统信息

### 2.2 界面缩放
程序默认适应1920×1080分辨率，在其他分辨率下会自动调整界面元素大小以保持最佳显示效果。

## 3. 基本操作

### 3.1 脚本录制
1. 点击工具栏中的「录制脚本」按钮或按 **F9** 键
2. 在屏幕上进行需要录制的操作
3. 完成后再次按 **F9** 键停止录制
4. 系统会自动保存录制的脚本，文件名为 `script_YYYYMMDD_HHMMSS.json`

### 3.2 脚本执行
1. 在脚本库中选择要执行的脚本
2. 点击工具栏中的「执行脚本」按钮或按 **F5** 键
3. 观察执行日志查看执行过程
4. 执行过程中可按 **F10** 键暂停执行

### 3.3 脚本管理
- **保存脚本**：在脚本编辑器中按 **Ctrl+S**
- **打开脚本**：点击工具栏「打开」按钮或按 **Ctrl+O**
- **新建脚本**：点击工具栏「新建」按钮或按 **Ctrl+N**

## 4. 高级功能

### 4.1 本地化设置
程序支持多语言切换功能，默认会根据系统语言自动选择合适的界面语言。已修复中文显示问题，确保所有文本正确显示。

1. 点击「工具」菜单中的「设置」
2. 在「语言」选项卡中选择 preferred language
3. 重启程序使更改生效

当前支持的语言：中文(简体)、English

### 4.2 图像识别设置
1. 点击「工具」菜单中的「设置」
2. 在「图像识别」选项卡中调整识别阈值
3. 设置模板匹配精度（0.1-1.0）
4. 配置截图区域和频率

### 4.3 快捷键自定义
1. 进入「设置」窗口的「快捷键」选项卡
2. 选择要修改的功能
3. 点击「更改快捷键」并按下新的按键组合
4. 点击「应用」保存更改

## 5. 故障排除

### 5.1 常见问题
- **脚本执行失败**：检查脚本文件是否损坏，尝试重新录制
- **图像识别不准确**：提高识别阈值，确保目标图像清晰
- **程序无响应**：关闭程序并重启，检查系统资源使用情况
- **快捷键不生效**：检查是否有其他程序占用了相同快捷键
- **中文显示问题**：程序已修复中文显示问题，确保使用UTF-8编码
- **编译错误**：尝试清除缓存目录（bin和obj文件夹）后重新编译

### 5.2 缓存清理
定期清理缓存目录可以解决一些编译和运行时问题：
1. 关闭程序
2. 删除项目根目录下的bin和obj文件夹
3. 删除src/ImageRecognitionApp目录下的bin和obj文件夹
4. 重新编译项目

### 5.2 获取帮助
- 查看「帮助」菜单中的「使用文档」
- 联系技术支持：support@imagerecogtool.com
- 访问官方网站：https://www.imagerecogtool.com

## 6. 附录

### 6.1 快捷键列表
| 功能 | 快捷键 |
|------|--------|
| 开始/停止录制 | F9 |
| 执行脚本 | F5 |
| 暂停录制 | F10 |
| 新建脚本 | Ctrl+N |
| 打开脚本 | Ctrl+O |
| 保存脚本 | Ctrl+S |
| 复制 | Ctrl+C |
| 粘贴 | Ctrl+V |

### 6.2 脚本文件格式说明
脚本文件采用JSON格式存储，每个操作包含以下字段：
- `action`：操作类型（click, keyboard等）
- `button`：鼠标按钮（left, right, middle）
- `x`, `y`：屏幕坐标
- `delay`：延迟时间（秒）
- `timestamp`：时间戳